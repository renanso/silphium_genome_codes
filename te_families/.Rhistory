legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs( x = NULL, y = "Gene count") + scale_y_continuous( limits = c(0, 100), breaks = seq(0, 100, by = 10))
ggplot(df_long4, aes(x = Species, y = Count, fill = (Species))) +
geom_col() +
theme_minimal(base_size = 15) +
#facet_wrap(~Class) +
#scale_fill_brewer(palette = "Spectral", name = "Genome") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 13, color = "black"),
axis.text.y = element_text(size = 13, color = "black"),
# legend.position = "top",
legend.title = element_text(face = "bold"),
legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs( x = NULL, y = "Gene count") + scale_y_continuous( limits = c(0, 100), breaks = seq(0, 100, by = 10))
ggplot(df_long4, aes(x = Species, y = Count, fill = (Species))) +
geom_col() +
theme_minimal(base_size = 15) +
#facet_wrap(~Class) +
#scale_fill_brewer(palette = "Spectral", name = "Genome") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 13, color = "black"),
axis.text.y = element_text(size = 13, color = "black"),
legend.position = element_blank(),
legend.title = element_text(face = "bold"),
legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs( x = NULL, y = "Gene count") + scale_y_continuous( limits = c(0, 100), breaks = seq(0, 100, by = 10))
ggplot(df_long4, aes(x = Species, y = Count, fill = (Species))) +
geom_col() +
theme_minimal(base_size = 15) +
#facet_wrap(~Class) +
#scale_fill_brewer(palette = "Spectral", name = "Genome") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 13, color = "black"),
axis.text.y = element_text(size = 13, color = "black"),
legend.position = element_text(element_blank()),
#legend.title = element_text(face = "bold"),
#legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs( x = NULL, y = "Gene count") + scale_y_continuous( limits = c(0, 100), breaks = seq(0, 100, by = 10))
ggplot(df_long4, aes(x = Species, y = Count, fill = (Species))) +
geom_col() +
theme_minimal(base_size = 15) +
#facet_wrap(~Class) +
#scale_fill_brewer(palette = "Spectral", name = "Genome") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 13, color = "black"),
axis.text.y = element_text(size = 13, color = "black"),
#legend.position = element_text(element_blank()),
#legend.title = element_text(face = "bold"),
#legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs( x = NULL, y = "Gene count") + scale_y_continuous( limits = c(0, 100), breaks = seq(0, 100, by = 10))
ggplot(df_long4, aes(x = Species, y = Count)) +
geom_col() +
theme_minimal(base_size = 15) +
#facet_wrap(~Class) +
#scale_fill_brewer(palette = "Spectral", name = "Genome") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 13, color = "black"),
axis.text.y = element_text(size = 13, color = "black"),
#legend.position = element_text(element_blank()),
#legend.title = element_text(face = "bold"),
#legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs( x = NULL, y = "Gene count") + scale_y_continuous( limits = c(0, 100), breaks = seq(0, 100, by = 10))
ggplot(df_long4, aes(x = Species, y = Count, fill = (Count))) +
geom_col() +
theme_minimal(base_size = 15) +
#facet_wrap(~Class) +
#scale_fill_brewer(palette = "Spectral", name = "Genome") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 13, color = "black"),
axis.text.y = element_text(size = 13, color = "black"),
#legend.position = element_text(element_blank()),
#legend.title = element_text(face = "bold"),
#legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs( x = NULL, y = "Gene count") + scale_y_continuous( limits = c(0, 100), breaks = seq(0, 100, by = 10))
ggplot(df_long3.1, aes(x = Species, y = Percentage, fill = reorder(Type, Percentage)))
ggplot(df_long4, aes(x = Species, y = Count, fill = (Count))) +
geom_col() +
theme_minimal(base_size = 15) +
#facet_wrap(~Class) +
scale_fill_brewer(palette = "Spectral", name = "Genome") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 13, color = "black"),
axis.text.y = element_text(size = 13, color = "black"),
#legend.position = element_text(element_blank()),
#legend.title = element_text(face = "bold"),
#legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs( x = NULL, y = "Gene count") + scale_y_continuous( limits = c(0, 100), breaks = seq(0, 100, by = 10))
ggplot(df_long4, aes(x = Species, y = Count, fill = (Count))) +
geom_col() +
theme_minimal(base_size = 15) +
#facet_wrap(~Class) +
scale_fill_brewer() +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 13, color = "black"),
axis.text.y = element_text(size = 13, color = "black"),
#legend.position = element_text(element_blank()),
#legend.title = element_text(face = "bold"),
#legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs( x = NULL, y = "Gene count") + scale_y_continuous( limits = c(0, 100), breaks = seq(0, 100, by = 10))
ggplot(df_long4, aes(x = Species, fill = as.factor(Count)))
ggplot(df_long4, aes(x = Species, fill = (Count)))
ggplot(df_long4, aes(x = Species, fill = (Count))) +
geom_col() +
theme_minimal(base_size = 15) +
#facet_wrap(~Class) +
scale_fill_brewer(palette = "Spectral", name = "Genome") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 13, color = "black"),
axis.text.y = element_text(size = 13, color = "black"),
#legend.position = element_text(element_blank()),
#legend.title = element_text(face = "bold"),
#legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs( x = NULL, y = "Gene count") + scale_y_continuous( limits = c(0, 100), breaks = seq(0, 100, by = 10))
ggplot(df_long4, aes(x = Species, y = Count, fill = (Count))) +
geom_col() +
theme_minimal(base_size = 15) +
#facet_wrap(~Class) +
scale_fill_brewer(palette = "Spectral", name = "Genome") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 13, color = "black"),
axis.text.y = element_text(size = 13, color = "black"),
#legend.position = element_text(element_blank()),
#legend.title = element_text(face = "bold"),
#legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs( x = NULL, y = "Gene count") + scale_y_continuous( limits = c(0, 100), breaks = seq(0, 100, by = 10))
ggplot(df_long4, aes(x = Species, y = Count, fill = (Species))) +
geom_col() +
theme_minimal(base_size = 15) +
#facet_wrap(~Class) +
scale_fill_brewer(palette = "Spectral", name = "Genome") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 13, color = "black"),
axis.text.y = element_text(size = 13, color = "black"),
#legend.position = element_text(element_blank()),
#legend.title = element_text(face = "bold"),
#legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs( x = NULL, y = "Gene count") + scale_y_continuous( limits = c(0, 100), breaks = seq(0, 100, by = 10))
ggplot(df_long4, aes(x = Species, y = Count, fill = (Species)))
ggplot(df_long4, aes(x = Species, y = Count, fill = (Species))) +
geom_col() +
theme_minimal(base_size = 15) +
#facet_wrap(~Class) +
scale_fill_brewer(palette = "Spectral", name = "Genome") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 13, color = "black"),
axis.text.y = element_text(size = 13, color = "black"),
#legend.position = element_text(element_blank()),
#legend.title = element_text(face = "bold"),
#legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs( x = NULL, y = "Gene count") + scale_y_continuous( limits = c(0, 50000), breaks = seq(0, 100, by = 10))
ggplot(df_long4, aes(x = Species, y = Count, fill = (Species))) +
geom_col() +
theme_minimal(base_size = 15) +
#facet_wrap(~Class) +
scale_fill_brewer(palette = "Spectral", name = "Genome") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 13, color = "black"),
axis.text.y = element_text(size = 13, color = "black"),
#legend.position = element_text(element_blank()),
#legend.title = element_text(face = "bold"),
#legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs( x = NULL, y = "Gene count") + scale_y_continuous( limits = c(0, 50000), breaks = seq(0, 50000, by = 10000))
ggplot(df_long4, aes(x = Species, y = Count, fill = (Species))) +
geom_col() +
theme_minimal(base_size = 15) +
#facet_wrap(~Class) +
scale_fill_brewer(palette = "Spectral", name = "Genome") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 13, color = "black"),
axis.text.y = element_text(size = 13, color = "black"),
legend.position = element_text(element_blank()),
#legend.title = element_text(face = "bold"),
#legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs( x = NULL, y = "Gene count") + scale_y_continuous( limits = c(0, 50000), breaks = seq(0, 50000, by = 10000))
ggplot(df_long4, aes(x = Species, y = Count, fill = (Species))) +
geom_col() +
theme_minimal(base_size = 15) +
#facet_wrap(~Class) +
scale_fill_brewer(palette = "Spectral", name = "Genome") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 13, color = "black"),
axis.text.y = element_text(size = 13, color = "black"),
legend.position = "none",
#legend.position = element_text(element_blank()),
#legend.title = element_text(face = "bold"),
#legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs( x = NULL, y = "Gene count") + scale_y_continuous( limits = c(0, 50000), breaks = seq(0, 50000, by = 10000))
ggsave("gene_count.jpeg", width = 4, height = 4, dpi = 200)
df_long4 <- df4 %>% pivot_longer(cols = starts_with(c("S.", "H.")),names_to = "Species",values_to = "Count")
df_long4 <- df_long4 %>% mutate(Species_ordered = factor(Species, levels = order))
str(df_long4)
ggplot(df_long4, aes(x = Species_ordered, y = Count, fill = (Species))) +
geom_col() +
theme_minimal(base_size = 15) +
#facet_wrap(~Class) +
scale_fill_brewer(palette = "Spectral", name = "Genome") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 13, color = "black"),
axis.text.y = element_text(size = 13, color = "black"),
legend.position = "none",
#legend.position = element_text(element_blank()),
#legend.title = element_text(face = "bold"),
#legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs( x = NULL, y = "Gene count") + scale_y_continuous( limits = c(0, 50000), breaks = seq(0, 50000, by = 10000))
ggsave("gene_count.jpeg", width = 4, height = 4, dpi = 200)
# data
df1<- read.csv("te_species_count.csv")
df2<- read.csv("te_species_bp.csv")
df3<- read.csv("te_species_percentage.csv")
df4<- read.csv("gene_count.csv")
# reshape to long format
order <- c("S.integrifolium", "S.perfoliatum", "H.annuus_HA412HO","H.annuus_XRQ", "S.taccada")
df_long1 <- df1 %>% pivot_longer(cols = starts_with(c("S.", "H.")),names_to = "Species",values_to = "Count")
df_long1 <- df_long1 %>% mutate(Species_ordered = factor(Species, levels = order))
library(tidyverse)
library(ggplot2)
library(scales)
# data
df1<- read.csv("te_species_count.csv")
df2<- read.csv("te_species_bp.csv")
df3<- read.csv("te_species_percentage.csv")
df4<- read.csv("gene_count.csv")
df4<- read.csv("gene_count.csv")
# data
df1<- read.csv("te_species_count.csv")
df2<- read.csv("te_species_bp.csv")
df3<- read.csv("te_species_percentage.csv")
df4<- read.csv("gene_count.csv")
# reshape to long format
order <- c("S.integrifolium", "S.perfoliatum", "H.annuus_HA412HO","H.annuus_XRQ", "S.taccada")
df_long1 <- df1 %>% pivot_longer(cols = starts_with(c("S.", "H.")),names_to = "Species",values_to = "Count")
df_long1 <- df_long1 %>% mutate(Species_ordered = factor(Species, levels = order))
df_long2 <- df2 %>% pivot_longer(cols = starts_with(c("S.", "H.")),names_to = "Species",values_to = "Base_pairs")
df_long2 <- df_long2 %>% mutate(Species_ordered = factor(Species, levels = order))
df_long3 <- df3 %>% pivot_longer(cols = starts_with(c("S.", "H.")),names_to = "Species",values_to = "Percentage")
df_long3 <- df_long3 %>% mutate(Species_ordered = factor(Species, levels = order))
df_long4 <- df4 %>% pivot_longer(cols = starts_with(c("S.", "H.")),names_to = "Species",values_to = "Count")
df_long4 <- df_long4 %>% mutate(Species_ordered = factor(Species, levels = order))
View(df_long3)
str(df_long4)
#plot
ggplot(df_long1, aes(x = Species_ordered, y = Count, fill = Class)) +
geom_col() +
theme_minimal(base_size = 12) +
scale_fill_brewer(palette = "Set2", name = "TE Class") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 12, color = "black"),
axis.text.y = element_text(size = 12, color = "black"),
#legend.position = "top",
legend.title = element_text(face = "bold"),
legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs(x = NULL, y = "Sequences Count")
ggsave("TE_counts.jpeg", width = 4, height = 4, dpi = 200)
ggplot(df_long2, aes(x = Species_ordered, y = Base_pairs, fill = Class)) +
geom_col() +
theme_minimal(base_size = 12) +
scale_fill_brewer(palette = "Set2", name = "TE Class") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 12, color = "black"),
axis.text.y = element_text(size = 12, color = "black"),
#legend.position = "top",
legend.title = element_text(face = "bold"),
legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs( x = NULL, y = "Base pairs (bp)")
ggsave("TE_basepairs.jpeg", width = 4, height = 4, dpi = 200)
ggplot(df_long3, aes(x = Species_ordered, y = Percentage, fill = Class)) +
geom_col() +
theme_minimal(base_size = 12) +
scale_fill_brewer(palette = "Set2", name = "TE Class") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 12, color = "black"),
axis.text.y = element_text(size = 12, color = "black"),
#legend.position = "top",
legend.title = element_text(face = "bold"),
legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs( x = NULL, y = "Percentage (%)")
ggsave("TE_percentage.jpeg", width = 4, height = 4, dpi = 200)
df_long3.1 <- df3[,c(1,2,6,7)] %>% pivot_longer(cols = starts_with(c("S.", "H.")),names_to = "Species",values_to = "Percentage")
ggplot(df_long3.1, aes(x = Species, y = Percentage, fill = reorder(Type, Percentage))) +
geom_col() +
theme_minimal(base_size = 15) +
#facet_wrap(~Class) +
scale_fill_brewer(palette = "Spectral", name = "TE type") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 13, color = "black"),
axis.text.y = element_text(size = 13, color = "black"),
# legend.position = "top",
legend.title = element_text(face = "bold"),
legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs( x = NULL, y = "Percentage of the genome (%)") + scale_y_continuous( limits = c(0, 100), breaks = seq(0, 100, by = 10))
ggsave("TE_percentage_silphium.jpeg", width = 4, height = 4, dpi = 200)
library(tidyverse)
library(ggplot2)
library(scales)
# data
df1<- read.csv("te_species_count.csv")
df2<- read.csv("te_species_bp.csv")
df3<- read.csv("te_species_percentage.csv")
df4<- read.csv("gene_count.csv")
# reshape to long format
order <- c("S.integrifolium", "S.perfoliatum", "H.annuus_HA412HO","H.annuus_XRQ", "Sc.taccada")
df_long1 <- df1 %>% pivot_longer(cols = starts_with(c("S.", "H.")),names_to = "Species",values_to = "Count")
df_long1 <- df_long1 %>% mutate(Species_ordered = factor(Species, levels = order))
df_long2 <- df2 %>% pivot_longer(cols = starts_with(c("S.", "H.")),names_to = "Species",values_to = "Base_pairs")
df_long2 <- df_long2 %>% mutate(Species_ordered = factor(Species, levels = order))
df_long3 <- df3 %>% pivot_longer(cols = starts_with(c("S.", "H.")),names_to = "Species",values_to = "Percentage")
df_long3 <- df_long3 %>% mutate(Species_ordered = factor(Species, levels = order))
df_long4 <- df4 %>% pivot_longer(cols = starts_with(c("S.", "H.")),names_to = "Species",values_to = "Count")
df_long4 <- df_long4 %>% mutate(Species_ordered = factor(Species, levels = order))
str(df_long4)
#plot
ggplot(df_long1, aes(x = Species_ordered, y = Count, fill = Class)) +
geom_col() +
theme_minimal(base_size = 12) +
scale_fill_brewer(palette = "Set2", name = "TE Class") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 12, color = "black"),
axis.text.y = element_text(size = 12, color = "black"),
#legend.position = "top",
legend.title = element_text(face = "bold"),
legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs(x = NULL, y = "Sequences Count")
View(df_long1)
df_long1 <- df1 %>% pivot_longer(cols = starts_with(c("S", "H.")),names_to = "Species",values_to = "Count")
df_long1 <- df_long1 %>% mutate(Species_ordered = factor(Species, levels = order))
View(df_long1)
df_long1 <- df1 %>% pivot_longer(cols = starts_with(c("S", "H.")),names_to = "Species",values_to = "Count")
df_long1 <- df_long1 %>% mutate(Species_ordered = factor(Species, levels = order))
df_long2 <- df2 %>% pivot_longer(cols = starts_with(c("S", "H.")),names_to = "Species",values_to = "Base_pairs")
df_long2 <- df_long2 %>% mutate(Species_ordered = factor(Species, levels = order))
df_long3 <- df3 %>% pivot_longer(cols = starts_with(c("S", "H.")),names_to = "Species",values_to = "Percentage")
df_long3 <- df_long3 %>% mutate(Species_ordered = factor(Species, levels = order))
df_long4 <- df4 %>% pivot_longer(cols = starts_with(c("S", "H.")),names_to = "Species",values_to = "Count")
df_long4 <- df_long4 %>% mutate(Species_ordered = factor(Species, levels = order))
str(df_long4)
#plot
ggplot(df_long1, aes(x = Species_ordered, y = Count, fill = Class)) +
geom_col() +
theme_minimal(base_size = 12) +
scale_fill_brewer(palette = "Set2", name = "TE Class") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 12, color = "black"),
axis.text.y = element_text(size = 12, color = "black"),
#legend.position = "top",
legend.title = element_text(face = "bold"),
legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs(x = NULL, y = "Sequences Count")
ggsave("TE_counts.jpeg", width = 4, height = 4, dpi = 200)
ggplot(df_long2, aes(x = Species_ordered, y = Base_pairs, fill = Class)) +
geom_col() +
theme_minimal(base_size = 12) +
scale_fill_brewer(palette = "Set2", name = "TE Class") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 12, color = "black"),
axis.text.y = element_text(size = 12, color = "black"),
#legend.position = "top",
legend.title = element_text(face = "bold"),
legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs( x = NULL, y = "Base pairs (bp)")
ggsave("TE_basepairs.jpeg", width = 4, height = 4, dpi = 200)
ggplot(df_long3, aes(x = Species_ordered, y = Percentage, fill = Class)) +
geom_col() +
theme_minimal(base_size = 12) +
scale_fill_brewer(palette = "Set2", name = "TE Class") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 12, color = "black"),
axis.text.y = element_text(size = 12, color = "black"),
#legend.position = "top",
legend.title = element_text(face = "bold"),
legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs( x = NULL, y = "Percentage (%)")
ggsave("TE_percentage.jpeg", width = 4, height = 4, dpi = 200)
ggplot(df_long4, aes(x = Species_ordered, y = Count, fill = (Species))) +
geom_col() +
theme_minimal(base_size = 15) +
#facet_wrap(~Class) +
scale_fill_brewer(palette = "Spectral", name = "Genome") +
theme(panel.background = element_rect(fill = "white", color = NA),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "grey80", size = 0.3),
axis.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 13, color = "black"),
axis.text.y = element_text(size = 13, color = "black"),
legend.position = "none",
#legend.position = element_text(element_blank()),
#legend.title = element_text(face = "bold"),
#legend.text = element_text(size = 9),
plot.title = element_text(face = "bold", size = 13, hjust = 0.5, margin = margin(b = 6))) +
labs( x = NULL, y = "Gene count") + scale_y_continuous( limits = c(0, 50000), breaks = seq(0, 50000, by = 10000))
ggsave("gene_count.jpeg", width = 4, height = 4, dpi = 200)
